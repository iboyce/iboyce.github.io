---
title: 结构化机器学习项目
date: 2018-01-08 18:36:40
tags:
      - 深度学习
      - Andrew NG
      - 公开课
categories: AI梦
mathjax: true
---


## 机器学习策略

### 常见方法及局限
搭建深度学习模型后，模型达到了一定的准确率，若要再度提升算法效率，或许你会
![ng_ff](http://p15i7i801.bkt.clouddn.com/a6cbb32e4ed57cb8919ab52d32385fa6.png)
这里的问题在于，如此尝试诸多方法，或许半年就过去了，并且不见得会多有效。因此我们需要策略来加速这一过程，这正是此门课的独特之处。
### 正交化
使用早期的电视屏幕调整作比喻，分为上下钮、左右钮、梯形钮，此种情况更容易控制屏幕。这样在训练集、开发集、测试集达到好的效果之后，再将模型在真实世界使用。
### 使用单个评估指标
* 如查准及查全，使用F1 score代替，F1分数值是查准及查全的调和平均值——harmanic mean,当然它近似平均值
* 又如在真实的不同场景中，比如美国、中国、印度的图片识别猫的准确率不一致，可以直接求它们的平均值
* 以上针对算法的迭代优化选择而言，可以提高效率

### 优化指标及满足指标
即最优的，优化项目及满足项目，有多个指标时，可以先限定某些指标而专注于优化其中一个指标。举例而言，比如流行的智能音箱，优化唤醒率，而限制假阳率为24小时内最多1次，以此标准迭代算法。

### 训练、开发、测试集
* 开发集，叫称为交叉验证集，开发集的分布应于测试集一致
* 在早期机器学习阶段7：3，6：2：2是常见的划分方法，而在现代深度学习算法习惯使用大量的数据，故可用更小的比例使用到开发集和测试集。谨记住测试集的作用，它是为了评估投产系统的性能，它能高置信度评估的效果即可 ，所以它可能只要1万或十万即可，这远远比所有数据20%的比例少
* 在反色情猫分类器的例子中，将机器学习的过程分为独立两步，每一步找目标，即确定单一评估指标，第二步对准和射击目标
![ng_catclassify](http://p15i7i801.bkt.clouddn.com/908a5e3dc3f7dc7d1f94c07c53ded776.png)

### 机器的表现和人的表现
* 机器学习的准确度基本符合以下曲线,在追上人类以前发展很快，超越人类后发展很慢，它的上限即贝叶斯误差，也叫贝叶斯最优误差。
![ng_bayeserror](http://p15i7i801.bkt.clouddn.com/fb704ed94c43e03f1ae2ef08d9cd3506.png)
* 低于人类的时候发展快的原因可以从三个角度分析，一为可从人类视角分析，二为可获取人工标签，三可以更好的分析偏差和方差

### 可避免的偏差与方差
* 加入概念：[泛化误差](https://www.zhihu.com/question/27068705)：在机器学习中泛化误差是用来衡量一个学习机器推广未知数据的能力，一图胜千言
![ng_add_error](http://p15i7i801.bkt.clouddn.com/8e88161f43c636e5bebe07028dbe1934.png)
* 举猫分类器而言，可以使用人类的偏差率来接近贝叶斯误差，因为人类在这方面很擅长。若偏差已没有增进空间，可以在考虑减少方差，方差可以通过正则或加数据来减少。
![ng_catvoidbias](http://p15i7i801.bkt.clouddn.com/e9853c9e01bb2c77abd481430fb06680.png)
* 请注意人类水平的误差取决于具体目的，比如医学图像分类，不同的人的误差差率是不同的，估计贝叶斯误差可以使用最专业的团队的误差率
![ng_reducingavoid](http://p15i7i801.bkt.clouddn.com/22bcdef589b4b7470d106dd2f19a7e21.png)

### 理解人类的表现
* 人类擅长处理自然感知任务，如图像、语音及NLP识别，在这些方面超越人类比较困难。在近几年的发展中，特定的几个领域内，如医学图像（皮肤癌、BCG判断）等已经取得了比人类更好的结果。
* 而在以下方面，机器学习已经远远超越了人类，它们的共同点是有大量的历史数据
  * 广告点击
  * 推荐
  * 预测用时——快递及运输
  * 还贷

### 误差分析
在猫分类的例子中，假若你的错误率是10%，你的队员可能注意到有不少猫被识别成了猫，他可能建议你针对狗的优化算法，试想你可以收集更多狗的照片或设计一些只处理狗的算法，这样单独起一个项目会花费上月的时间，在这里建议一个简单的法子
* 在开发集中取出100个被错误分类的例子
* 取出是狗的例子,找出它的特点，比如模糊的图像、滤镜的图像，这样你就更能理解你的分类器，具体看情况去处理它了。
![ng_catdect](http://p15i7i801.bkt.clouddn.com/3cc21a20da564a3f00f4af0954e0937b.png)
* 对于错误标记的数据是是否需要修正，依情况而定，同样用错误表来分析，若主要问题在其它因素上，暂暂时不用管，反之则分析。如图。
![ng_bias](http://p15i7i801.bkt.clouddn.com/09d9124ea0149ce6c349e1657a4fc015.png)
* 不管什么模型，也许很多研究人员、工程师都认为喂数据即可，其它人工分析是很有必要的，至少NG经常这么干，手工和这些错误做斗争可以快速的了解到工作的重点，这是很值得做的。强烈建议


### 快速的搭建系统并迅速迭代
* 寻找好特定领域的方向，划分训练开发集并设定单一评估指标，迅速搭建初始系统并使用偏差/方差分析或误差分析理论去优化下一步。
* 实际情况训练和测试分布往往不一致，两者数据都打散然后划分是不可取的，目标的准心就有偏差了。经常的做法是，将测试数据加入训练集，而开发集和测试集只使用目标真实数据。
![ng_diffdis](http://p15i7i801.bkt.clouddn.com/001e95d226208589b6ac79293b6e7cd0.png)
* 在不匹配数据划分的情况下的误差分析，我们往往加入训练开发混合集去定位误差是否是数据匹配问题导致的。对于下图最右边deverror和testerror比trainerror还小的情况，可以通过第二张片子来进一步分析，图上是车镜语音场景的一个例子。
![NG_trainde](http://p15i7i801.bkt.clouddn.com/9765181a9909f8540596dcdb5cd05d75.png)
![ng_moreformula](http://p15i7i801.bkt.clouddn.com/a13ab0be285d7f4d6ee8e3220231b042.png)
* 对于确定是数据不匹配的问题导致的误差，没有系统的解决方案，可以从以下两个角度尝试：
  * 手动分析误差并理解训练和开发测试集的分布差异
  * 使得测试集的数据分布向测试集靠近，可能通过增加数据或人造数据的方式
* 人造数据要注意的是，防止增加一小部分数据而造成模型对这一部分数据过拟合，用汽车识别的例子，若只取游戏中的车的合成图片，即便有海量的张数，但汽车的各类只有20种，这样就不行。
![ng_artificalsynthesis](http://p15i7i801.bkt.clouddn.com/c7c6fb7cc985c944c32ca31d9eaef00b.png)

### 迁移学习
* 迁移学习的过程，如下图所示，把输出层换成自己的层和输出层，再用自有数据训练。从原理上来说即利用其它模型已经学习到的特征，如轮廓、边、角等等基础特征
![ng_transfer](http://p15i7i801.bkt.clouddn.com/561cacd18c3d8ecdc8a228a19260f6ae.png)
* 从原理上理解，什么场景下适合迁移学习呢，对于那些比较难收集数据的场景，如射线科，如果有基础特征类似的基础场景已经较好的训练了便可以尝试迁移

### 多任务学习
* 原理，注意和softmax的区别，它的目标有多个
![ng_MULTITASK](http://p15i7i801.bkt.clouddn.com/23c7fec2fb7b2bc578289f69ddeb0fa1.png)
* 什么情况下多任务学习
![ng_shouldmulti](http://p15i7i801.bkt.clouddn.com/d01097fa3af60c0103a5921c0bd989d0.png)

### 端到端的深度学习及适用场景
* 它省去了传统机器学习的各类环节，在以往也许有的研究人员终其一生都在设计这些环节
![ng_dotdot](http://p15i7i801.bkt.clouddn.com/3d78944e1e5fa81760fc5ac9700e0182.png)
* 在人脸识别中我们先目标检测再做识别，如果要端对端的话，这需要大量的数据。传统机器翻译需要先做文本分析，再提取特征等等，端对端的学习在这种场景下非常适应，因为它有大量的数据。
* 因此关键的问题是有没有
